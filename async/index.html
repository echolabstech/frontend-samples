<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>promise.all async example</title>
</head>
<body>

	<script>
		function animations() {
			const spriteAnimation = new Promise((resolve, reject) => {
				setTimeout(() => {
					console.log('sprite animation complete');
					resolve(100);
				}, 1000)
			});

			const badgeAnimation = new Promise((resolve, reject) => {
				setTimeout(() => {
					console.log('badge animation complete');
					resolve(100);
				}, 3000)
			});

			return Promise.all([spriteAnimation, badgeAnimation]);
		}

		function popups() {
			return new Promise((resolve, reject) => {
				setTimeout(() => {
					console.log('show popup');
					const button = document.createElement('button');
					button.onclick = () => {
						console.log('close popup');
						resolve(100);
					}
					button.textContent = 'close popup';
					document.body.appendChild(button);
				}, 1000)
			});
		}

		async function main() {
			console.log('before');
			await popups();
			await animations();
			console.log('after');
		}
		main();
	</script>
</body>
</html>